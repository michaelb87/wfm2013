<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	template="/WEB-INF/templates/template.xhtml">
	<ui:define name="content">
		<f:metadata>
			<f:viewParam name="taskId" />
			<f:event type="preRenderView"
				listener="#{businessProcess.startTask(taskId, true)}" />
		</f:metadata>
		
		<h:outputText value="#{processVariables['failmessage']}" rendered = "#{processVariables['validation']=='failed'}" class="text-error"/>

		<h1>Hello ${user.username}!</h1>
		<h:form>
			<p class="text-info">
				
				<br />Please subscribe to a course you want to
				attend!
			</p>
			
			

			<h:dataTable value="#{courses.items}" var="v_course" id="courseList"
				frame="box" styleClass="rounded-corner" rowClasses="odd,even">
				<h:column>
					<f:facet name="header">
						<div id="start">Number</div>
					</f:facet>
					<h:outputText value="#{v_course.course.course_nr}" />
					<f:facet name="footer">
						<div id="start"></div>
					</f:facet>
				</h:column>
				<h:column>
					<f:facet name="header">
						<div id="mid">Name</div>
					</f:facet>
					<h:outputText value="#{v_course.course.name}" />
					<f:facet name="footer">
						<div id="mid"></div>
					</f:facet>
				</h:column>
				<h:column>
					<f:facet name="header">
						<div id="mid">Description</div>
					</f:facet>
					<h:outputText value="#{v_course.course.desc}" />
					<f:facet name="footer">
						<div id="mid"></div>
					</f:facet>
				</h:column>
				<h:column>
					<f:facet name="header">
						<div id="mid">Trainer</div>
					</f:facet>
					<h:outputText value="#{v_course.course.trainer}" />
					<f:facet name="footer">
						<div id="mid"></div>
					</f:facet>
				</h:column>
				<h:column>
					<f:facet name="header">
						<div id="mid">Capacity</div>
					</f:facet>
					<h:outputText value="#{v_course.course.maxMembers}" />
					<f:facet name="footer">
						<div id="mid"></div>
					</f:facet>
				</h:column>
				<h:column>
					<f:facet name="header">
						<div id="mid">Indoor</div>
					</f:facet>
					<h:selectBooleanCheckbox value="#{v_course.course.indoor}" disabled="true"/>
					<f:facet name="footer">
						<div id="mid"></div>
					</f:facet>
				</h:column>
				<h:column>
					<f:facet name="header">
						<div id="mid">Action</div>
					</f:facet>
					<h:commandLink value="Subscribe"
						action="#{registerCourseTask.registerCourse(taskId, v_course.course.course_nr)}"
						rendered="#{!courses.checkSubscription(v_course.course.course_nr)}" />
					<h:outputText id="textSubscribed" value="#{courses.subscribedText}"
						rendered="#{courses.checkSubscription(v_course.course.course_nr)}" />
					<f:facet name="footer">
						<div id="mid"></div>
					</f:facet>
				</h:column>
			</h:dataTable>

			<br/>
			<h:commandButton class="btn btn-large" action="#{registerCourseTask.logout(taskId)}"
				value="Logout" type="submit" />

		</h:form>
	</ui:define>
</ui:composition>